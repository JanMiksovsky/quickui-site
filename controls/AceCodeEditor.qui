<!--
Ace code editor wrapper.
Must set an ID on a control instance for this to work!
-->

<Control className="AceCodeEditor">

<script>
AceCodeEditor.prototype.extend({
    
    content: function( content ) {
        var editor = this._editor();
        if ( content === undefined ) {
            return editor
                ? editor.getSession().getValue()
                : this._content();
        } else {
            if ( editor ) {
                editor.getSession().setValue( content );
            } else {
                this._content( content );
            }
            return this;
        }
    },
    
    initialize: function() {
        this.inDocument( function( $control ) {
            var content = $control.content();
            var id = $control.prop( "id" );
            var editor = ace.edit( id );
            $control._editor( editor );
            var session = editor.getSession();
            session.setUseSoftTabs( true );
            editor.renderer.setShowGutter( false );
            editor.renderer.setHScrollBarAlwaysVisible( false );
            var JavaScriptMode = require( "ace/mode/javascript" ).Mode;
            session.setMode( new JavaScriptMode() );
            $control.content( content );
        });
    },
    
    // Copy of the content, used to save content until editor is ready.
    _content: Control.property(),
    
    _editor: Control.property()
});
</script>

</Control>
